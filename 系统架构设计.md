# 学生成绩查询系统架构设计

## 1. 系统概述

本系统是一个基于Web的学生成绩查询系统，支持教师录入成绩、学生查询成绩，并具备时间段控制功能。系统采用前后端分离架构，集成腾讯云服务。

## 2. 技术栈

### 前端技术栈
- **框架**: React 18 + TypeScript
- **UI组件库**: Ant Design
- **路由管理**: React Router v6
- **HTTP客户端**: Axios
- **状态管理**: Zustand
- **构建工具**: Vite
- **样式**: Ant Design

### 后端技术栈
- **框架**: Spring Boot 3.5.6 + Java 21
- **安全框架**: JWT (自定义实现)
- **数据访问**: MyBatis 3.0.3
- **Web框架**: Spring Web (RESTful API)
- **文件处理**: Apache POI (Excel解析)
- **数据库**: MySQL 8.0
- **构建工具**: Maven
- **文档**: Springdoc OpenAPI 3

### 腾讯云服务
- **数据库**: 腾讯云MySQL
- **文件存储**: 腾讯云COS
- **CDN**: 腾讯云CDN
- **计算**: 腾讯云CVM
- **域名**: 腾讯云DNSPod
- **负载均衡**: 腾讯云CLB

## 3. 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                        用户层                                │
├─────────────────┬─────────────────┬─────────────────────────┤
│   学生用户      │   教师用户      │     管理员用户           │
└─────────────────┴─────────────────┴─────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                      前端层 (React)                          │
├─────────────────────────────────────────────────────────────┤
│  • 学生成绩查询界面    • 教师成绩录入界面    • 管理员界面      │
│  • 文件上传组件        • 时间段控制界面      • 用户管理界面    │
│  • 响应式设计          • 数据可视化          • 系统配置界面    │
└─────────────────────────────────────────────────────────────┘
                            │ HTTPS
┌─────────────────────────────────────────────────────────────┐
│                    API网关层 (Spring Boot)                   │
├─────────────────────────────────────────────────────────────┤
│  • 身份认证 (JWT)      • 权限控制          • 请求路由         │
│  • 数据验证            • 异常处理          • 日志记录         │
└─────────────────────────────────────────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                    业务逻辑层 (Spring Boot)                  │
├─────────────────────────────────────────────────────────────┤
│  • 学生服务            • 教师服务          • 管理员服务       │
│  • 成绩管理服务        • 文件处理服务      • 时间段控制服务   │
│  • 用户认证服务        • 权限管理服务      • 通知服务         │
└─────────────────────────────────────────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                     数据访问层 (MyBatis)                     │
├─────────────────────────────────────────────────────────────┤
│  • 学生实体            • 成绩实体          • 用户实体         │
│  • 课程实体            • 时间段实体        • 教师实体         │
│  • MyBatis映射器       • SQL映射文件       • 数据访问接口     │
└─────────────────────────────────────────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                     数据存储层 (腾讯云)                       │
├─────────────────────────────────────────────────────────────┤
│  • 腾讯云MySQL         • 腾讯云COS (文件存储)               │
│  • 腾讯云CDN           • 腾讯云监控                         │
└─────────────────────────────────────────────────────────────┘
```

## 4. 核心功能模块

### 4.1 学生功能模块
- **成绩查询**: 查看个人成绩，支持按学期筛选
- **个人信息查询**: 查看个人基本信息
- **时间段控制**: 只能在指定时间段内查询成绩

### 4.2 教师功能模块
- **成绩录入**: 单个成绩录入和批量导入
- **成绩管理**: 修改、删除成绩记录
- **时间段设置**: 设置成绩查询开放时间段
- **文件上传**: 支持Excel/CSV文件批量导入

### 4.3 管理员功能模块
- **学生信息管理**: 增删改查学生信息
- **教师信息管理**: 增删改查教师信息
- **课程信息管理**: 增删改查课程信息
- **时间段管理**: 设置成绩查询开放时间段

## 5. 数据库设计

### 逻辑外键与一致性策略
- 不创建数据库物理外键；由服务层校验跨表存在性与删除保护。
- 定时一致性审计与修复脚本保障长期数据健康。
- 索引策略覆盖“外键字段”，用于查询与约束但不施加物理FK。

### 5.1 核心实体
- **用户表 (users)**: 存储所有用户信息
- **学生表 (students)**: 存储学生详细信息
- **教师表 (teachers)**: 存储教师详细信息
- **课程表 (courses)**: 存储课程信息
- **成绩表 (grades)**: 存储成绩记录
- **时间段表 (time_periods)**: 存储查询时间段设置
- **文件上传表 (file_uploads)**: 存储文件上传记录
- **系统配置表 (system_configs)**: 存储系统配置
- **操作日志表 (operation_logs)**: 存储操作日志

### 5.2 关系设计
- 用户与学生：一对一关系
- 用户与教师：一对一关系
- 学生与成绩：一对多关系
- 教师与成绩：一对多关系
- 课程与成绩：一对多关系
- 时间段与成绩查询：一对多关系

## 6. API设计

### 6.1 认证相关API
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 用户登出
- `POST /api/auth/refresh` - 刷新Token

### 6.2 学生相关API
- `GET /api/students/profile` - 获取个人信息
- `GET /api/students/grades` - 查询成绩
- `GET /api/students/grades/{semester}` - 按学期查询成绩

### 6.3 教师相关API
- `POST /api/teachers/grades` - 录入成绩
- `PUT /api/teachers/grades/{id}` - 修改成绩
- `DELETE /api/teachers/grades/{id}` - 删除成绩
- `POST /api/teachers/grades/upload` - 批量导入成绩
- `POST /api/teachers/time-periods` - 设置查询时间段

### 6.4 管理员相关API
- `GET /api/admin/students` - 获取学生列表
- `POST /api/admin/students` - 添加学生
- `PUT /api/admin/students/{id}` - 修改学生信息
- `DELETE /api/admin/students/{id}` - 删除学生
- `GET /api/admin/teachers` - 获取教师列表
- `POST /api/admin/teachers` - 添加教师
- `PUT /api/admin/teachers/{id}` - 修改教师信息
- `DELETE /api/admin/teachers/{id}` - 删除教师
- `GET /api/admin/courses` - 获取课程列表
- `POST /api/admin/courses` - 添加课程
- `PUT /api/admin/courses/{id}` - 修改课程信息
- `DELETE /api/admin/courses/{id}` - 删除课程
- `GET /api/admin/time-periods` - 获取时间段列表
- `POST /api/admin/time-periods` - 添加时间段
- `PUT /api/admin/time-periods/{id}` - 修改时间段
- `DELETE /api/admin/time-periods/{id}` - 删除时间段

## 7. 安全设计

### 7.1 身份认证
- JWT Token认证（自定义实现）
- Token过期机制

### 7.2 权限控制
- 基于角色的访问控制 (RBAC)
- API级别的权限验证
- 前端路由权限控制

### 7.3 数据安全
- HTTPS传输加密
- 敏感数据加密存储
- SQL注入防护
- XSS攻击防护

## 8. 性能优化

### 8.1 前端优化
- 代码分割和懒加载
- 缓存策略
- 虚拟滚动

### 8.2 后端优化
- 数据库索引优化
- MyBatis查询优化
- 连接池配置
- 逻辑外键校验优化


## 9. 部署架构

### 9.1 开发环境
- 本地开发服务器
- Docker容器化
- 热重载支持

### 9.2 生产环境
- 腾讯云部署
- Docker容器化
- Nginx反向代理

## 10. 监控和日志

### 10.1 监控
- 腾讯云监控
- 应用性能监控 (APM)
- 错误追踪和告警

### 10.2 日志
- 结构化日志记录
- 日志聚合和分析
- 审计日志

## 11. 成本优化

### 11.1 腾讯云成本优化
- 使用竞价实例
- COS智能分层
- MySQL预留实例
- CDN缓存优化

### 11.2 应用成本优化
- 数据库查询优化
- 缓存策略
- 资源使用监控
